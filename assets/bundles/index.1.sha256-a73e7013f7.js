import{r as n,j as e,R as J}from"./index.1.sha256-491025a480.js";import{u as U,a as G,P as W,l as Q,E as X,g as e2}from"./stripe.1.sha256-62f2b2ae2f.js";import{c as L}from"./index.1.sha256-2204be5363.js";import{p as t2}from"./purify.es.1.sha256-e313442a48.js";import{u as n2}from"./dataHooks.1.sha256-3888564008.js";import{h as s2,s as z,A as D}from"./notifications.1.sha256-22ce999815.js";import{v as a2,f as r2}from"./payment.1.sha256-3e00ce992f.js";import{S as i2}from"./Spinner.1.sha256-b63f390a52.js";import{a as F,S}from"./tracking.1.sha256-c760b2e67b.js";import"./internal_customer_edit_inner.1.sha256-34481b9084.js";import{u as o2}from"./useEffectOnce.1.sha256-ede3d12bd3.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new s.Error().stack;o&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[o]="44f44ba3-be26-44ba-bf1f-311dd7ec8b0c",s._sentryDebugIdIdentifier="sentry-dbid-44f44ba3-be26-44ba-bf1f-311dd7ec8b0c")}catch{}const l2="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='15'%20height='14'%20viewBox='0%200%2015%2014'%20fill='none'%3e%3cpath%20d='M12.75%206.99996C12.75%206.35654%2012.2267%205.83329%2011.5833%205.83329H10.4167V4.08329C10.4167%202.47504%209.10825%201.16663%207.5%201.16663C5.89175%201.16663%204.58333%202.47504%204.58333%204.08329V5.83329H3.41667C2.77325%205.83329%202.25%206.35654%202.25%206.99996V11.6666C2.25%2012.31%202.77325%2012.8333%203.41667%2012.8333H11.5833C12.2267%2012.8333%2012.75%2012.31%2012.75%2011.6666V6.99996ZM5.75%204.08329C5.75%203.11846%206.53517%202.33329%207.5%202.33329C8.46483%202.33329%209.25%203.11846%209.25%204.08329V5.83329H5.75V4.08329Z'%20fill='%23B0B8C2'/%3e%3c/svg%3e",c2="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='31'%20height='14'%20viewBox='0%200%2031%2014'%20fill='none'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M21.2434%204.00728C22.6438%204.00732%2023.9636%205.27542%2023.9637%207.60863C23.9637%2010.1593%2022.6586%2011.3117%2021.2362%2011.3119C20.7188%2011.3125%2020.2172%2011.1328%2019.8206%2010.8045V13.0726L17.8264%2013.5V4.13749H19.5785L19.6817%204.63782C19.8872%204.43636%2020.1312%204.27681%2020.3991%204.16863C20.6671%204.06053%2020.954%204.00563%2021.2434%204.00728ZM20.7815%205.78283C20.6026%205.77493%2020.4237%205.80658%2020.2588%205.87554C20.0941%205.94446%2019.9472%206.04904%2019.8284%206.18125V9.15985C19.9467%209.28743%2020.0923%209.38769%2020.2545%209.45282C20.4167%209.51794%2020.5917%209.54625%2020.7665%209.53633C21.507%209.53633%2022.0131%208.70318%2022.0131%207.6525C22.0131%206.60182%2021.5147%205.78295%2020.7815%205.78283Z'%20fill='%23B0B8C2'/%3e%3cpath%20d='M3.19809%204.00728C3.87618%204%204.54929%204.12548%205.17798%204.37669V6.28245C4.56991%205.95443%203.89069%205.77563%203.19809%205.7609C2.78028%205.76094%202.51641%205.8844%202.51641%206.20319C2.51677%207.11602%205.56651%206.68147%205.60332%209.11597C5.60332%2010.5725%204.45923%2011.406%202.80211%2011.406C2.04419%2011.4053%201.2946%2011.2476%200.602396%2010.9425V8.99283C1.27401%209.37689%202.02751%209.60053%202.80211%209.64531C3.21273%209.64531%203.53535%209.52181%203.53535%209.14498C3.53504%208.18139%200.500072%208.54354%200.5%206.29731C0.5%204.86256%201.57776%204.00736%203.19809%204.00728Z'%20fill='%23B0B8C2'/%3e%3cpath%20d='M8.26489%204.17429H9.77576V5.86988H8.26489V8.7685C8.26502%209.97121%209.51914%209.60185%209.77576%209.49316V11.1236C9.337%2011.3211%208.8568%2011.4131%208.37516%2011.3918C8.09908%2011.3969%207.82451%2011.3464%207.56888%2011.2432C7.31326%2011.1401%207.08144%2010.9864%206.88792%2010.7917C6.69441%2010.5971%206.54314%2010.3653%206.44325%2010.111C6.34338%209.8566%206.29721%209.58465%206.3072%209.312V2.84033L8.25057%202.42068L8.26489%204.17429Z'%20fill='%23B0B8C2'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27.6442%204.00728C29.5652%204.00728%2030.5629%205.64501%2030.4969%207.72469V8.44934H26.5522C26.6548%209.39862%2027.3292%209.68139%2028.1211%209.6814C28.808%209.69217%2029.4875%209.53791%2030.101%209.23203V10.8625C29.4255%2011.2217%2028.6681%2011.4042%2027.9012%2011.3918C25.9362%2011.3918%2024.5573%2010.1525%2024.5573%207.71053C24.5573%205.64538%2025.7233%204.00747%2027.6442%204.00728ZM27.6299%205.6597C27.1312%205.6597%2026.5665%206.04379%2026.5665%206.95686H28.6567C28.6567%206.04379%2028.1285%205.6597%2027.6299%205.6597Z'%20fill='%23B0B8C2'/%3e%3cpath%20d='M13.152%204.07663C13.4545%203.96724%2013.7872%203.97113%2014.0871%204.08725V5.93498C13.8231%205.84549%2013.5373%205.83794%2013.2687%205.91304C13.0002%205.98816%2012.7615%206.14251%2012.5841%206.35534V11.1236H10.6186V4.08725H12.3199L12.4445%204.68099C12.5977%204.40101%2012.8495%204.18606%2013.152%204.07663Z'%20fill='%23B0B8C2'/%3e%3cpath%20d='M16.8289%204.13749V11.1236H14.8275V4.13749H16.8289Z'%20fill='%23B0B8C2'/%3e%3cpath%20d='M16.8289%203.06537L14.8275%203.47865V1.91328L16.8289%201.5V3.06537Z'%20fill='%23B0B8C2'/%3e%3c/svg%3e",m2="_buttonWrapper_be1ye_6",d2="_paymentElement_be1ye_13",p2="_paymentElementWithSaveButton_be1ye_18",u2="_saveButtonWithStripe_be1ye_27",f2="_stripeSecure_be1ye_41",y2="_stripeIcon_be1ye_50",l={buttonWrapper:m2,paymentElement:d2,paymentElementWithSaveButton:p2,saveButtonWithStripe:u2,stripeSecure:f2,stripeIcon:y2},$=n.forwardRef(({aboveButtonContents:s,authToken:o,buttonClassNames:v,buttonContents:w,buttonSubmittingVerb:E,className:P,clientSecret:_,customerData:r,customSegmentPayload:C,onCompleteChanged:I,onFailedOrderAuthorization:V,onFocus:x,onReady:B,onSuccessfulCardSubmission:j,secondaryButtonClassNames:M,secondaryButtonOnClick:h,secondaryButtonText:H,showSaveButton:p=!0},b)=>{const c=U(),a=G(),[m,u]=n.useState(!1),[R,d]=n.useState(!1),[N,g]=n.useState(!1),[Z,f]=n.useState(!1),O=()=>{g(!0),B?.()},A=async(t=!1)=>{if(u(!0),s2(),!c||!a){u(!1);return}const{error:i,setupIntent:q}=await c.confirmSetup({elements:a,redirect:"if_required",confirmParams:{return_url:window.location.toString()}});try{if(i){const y=t2.sanitize(i.message);if(z(`${y} Please try again or contact <a href="mailto:care@rinse.com" class="link--underline">care@rinse.com</a>.`,D.Danger),F(S.PaymentEntryFailed,{code:i.code,decline_code:i.decline_code,message:i.message,type:i.type}),t)throw new Error(i.message)}else try{const y=await a2(_,q,o),{orderAuthorizationSucceeded:k}=y;F(S.PaymentEntrySuccess),k!==null&&!k?await V?.():await j()}catch(y){throw z('Your card could not be added. Please try again or contact <a href="mailto:care@rinse.com" class="link--underline">care@rinse.com</a>.',D.Danger),y}}finally{u(!1)}},K=async t=>{t.preventDefault(),t.stopPropagation(),await A()},Y=t=>{d(t.complete),t.complete&&F(S.CompletedPaymentEntry,C?C[S.CompletedPaymentEntry]:void 0),t.complete!==Z&&(I?.(t.complete),f(t.complete))};n.useImperativeHandle(b,()=>({focus:()=>{a?.getElement(W)?.focus()},submitPaymentMethod:()=>A(!0),updateZIPCode:t=>{a?.getElement(W)?.update({defaultValues:{billingDetails:{address:{postal_code:t,country:r?.country}}}})}}));const T=p?"form":"div";return e.jsxs(T,{className:P,onSubmit:K,children:[e.jsx("div",{className:L(l.paymentElement,p&&l.paymentElementWithSaveButton),children:e.jsx(W,{onReady:O,onChange:Y,onFocus:x,options:{readOnly:m,terms:{card:"never"},wallets:{applePay:"never",googlePay:"never"},defaultValues:{billingDetails:{address:{postal_code:r?.zipCode,country:r?.country},name:r?`${r?.firstName} ${r?.lastName}`:void 0}}}})}),s??null,N&&e.jsxs("div",{className:l.buttonWrapper,children:[!!h&&e.jsx("button",{className:L("rinse-button--secondary-new",...M),disabled:!c||m,onClick:h,type:"button",children:H}),p&&e.jsxs("div",{className:l.saveButtonWithStripe,children:[e.jsx("button",{className:L("rinse-button--primary-new",...v),"data-testid":"submit-payment-button",disabled:!c||m||!R,type:T==="form"?"submit":"button",children:m?`${E}â€¦`:w}),e.jsxs("div",{className:l.stripeSecure,children:[e.jsx("img",{src:l2,alt:"",className:l.stripeIcon}),e.jsx("span",{children:"Secured by"}),e.jsx("img",{src:c2,alt:"Stripe",className:l.stripeIcon})]})]})]})]})});$.displayName="PaymentInfoForm";const C2=n.forwardRef(({aboveButtonContents:s,authToken:o,buttonClassNames:v=[],buttonContents:w="Save",buttonSubmittingVerb:E="Saving",className:P,customerData:_,onCompleteChanged:r,onFocus:C,onReady:I,onSuccessfulCardSubmission:V,secondaryButtonClassNames:x=[],secondaryButtonOnClick:B,secondaryButtonText:j,show:M=!0,showLoadingSpinner:h,showSaveButton:H=!0},p)=>{const b=n2("STRIPE_PUBLISHABLE_KEY"),c=J.useMemo(()=>Q(b),[b]),[a,m]=n.useState(null),[u,R]=n.useState(!1),d=n.useRef(null),N=()=>{R(!0),I?.()},g=async()=>{const f=await r2(o);m(f)};if(n.useImperativeHandle(p,()=>({focus:()=>d.current?.focus(),refreshClientSecret:g,submitPaymentMethod:async()=>{await d.current?.submitPaymentMethod()},updateZIPCode:f=>{d.current?.updateZIPCode(f)}})),o2(()=>{a||g()}),!a)return null;const Z={clientSecret:a,appearance:e2({}),loader:"always"};return e.jsxs("div",{style:{display:M?void 0:"none"},children:[h&&!u&&e.jsx(i2,{}),e.jsx(X,{stripe:c,options:Z,children:e.jsx($,{aboveButtonContents:s,authToken:o,buttonClassNames:v,buttonContents:w,buttonSubmittingVerb:E,className:P,clientSecret:a,customerData:_,onCompleteChanged:r,onFocus:C,onReady:N,onSuccessfulCardSubmission:V,secondaryButtonClassNames:x,secondaryButtonOnClick:B,secondaryButtonText:j,showSaveButton:H,ref:d})},a)]})});C2.displayName="PaymentInfoFormContainer";export{C2 as P};
//# sourceMappingURL=index.1.sha256-a73e7013f7.js.map
