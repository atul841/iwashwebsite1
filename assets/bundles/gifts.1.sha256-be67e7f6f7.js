import{j as e,r as Y,R as x,a as pe}from"./index.1.sha256-491025a480.js";import{s as Te}from"./scroll-background-color.1.sha256-6119901d75.js";import{Z as Ge,B as De,e as Ve,L as He,E as $e,m as Pe,c as Be,r as qe}from"./utils.1.sha256-9ee1c54c60.js";import{B as Xe}from"./react-router-dom.1.sha256-d414cae460.js";import{S as Oe}from"./ScrollWrapper.1.sha256-45994818af.js";import{u as P}from"./dataHooks.1.sha256-3888564008.js";import{R as v,B}from"./RinseButton.1.sha256-31aa4971bc.js";import{u as We,a as Ye,P as Ze,l as Ue,E as ze,g as Ke}from"./stripe.1.sha256-62f2b2ae2f.js";import{a as Z}from"./index.1.sha256-7c8094d5f3.js";import{f as Je}from"./payment.1.sha256-3e00ce992f.js";import{s as _e}from"./tracking.1.sha256-c760b2e67b.js";import{o as Qe}from"./yup.1.sha256-7565e34740.js";import{i as et}from"./axios.1.sha256-fb82f1d9fe.js";import{C as R}from"./payment.1.sha256-2e30319982.js";import"./internal_customer_edit_inner.1.sha256-34481b9084.js";import{s as k,A as V,h as tt}from"./notifications.1.sha256-22ce999815.js";import{B as de,a as le}from"./BoxedGroupInputController.1.sha256-ef85648000.js";import{E as me}from"./EmailInputController.1.sha256-47b4940056.js";import{T as S}from"./TextInputController.1.sha256-ad21646c3c.js";import{u as it}from"./useRecaptcha.1.sha256-6711f2ea75.js";import{f as F}from"./stringUtils.1.sha256-2be81a19c5.js";import{n as H,e as ue}from"./validation.1.sha256-5c3897149a.js";import{c as I}from"./index.1.sha256-2204be5363.js";import{D as st}from"./DropdownInput.1.sha256-db525af3c9.js";import{u as at}from"./useMedia.1.sha256-3a779f1c03.js";import{C as rt,u as ot}from"./index.esm.1.sha256-6f50330ddf.js";import{a as ye,c as E,e as $,g as nt}from"./array.1.sha256-899a6845d3.js";import{c as ct}from"./Lazy.1.sha256-c80805b83f.js";import{u as dt,S as lt,f as fe}from"./react-router.1.sha256-d433f16b4e.js";import{w as mt}from"./formik.esm.1.sha256-25019f7afc.js";import{a as z}from"./js.cookie.1.sha256-b274c81169.js";import{O as ut}from"./OutlinedNotchInput.1.sha256-8ce0a242e9.js";import{D as ft}from"./index.1.sha256-f7724c6ecf.js";import{u as he}from"./useEffectOnce.1.sha256-ede3d12bd3.js";/* empty css                         */import"./_commonjsHelpers.1.sha256-d18bdf7c2f.js";import"./moment.1.sha256-e1e16e85b3.js";import"./inheritsLoose.1.sha256-9d1d51b64e.js";import"./setPrototypeOf.1.sha256-862ec942ec.js";import"./objectWithoutPropertiesLoose.1.sha256-155261ed69.js";import"./index.1.sha256-3e0f416b3f.js";import"./hoist-non-react-statics.cjs.1.sha256-94177b68a7.js";import"./Button.1.sha256-35f576c90e.js";import"./index.1.sha256-69bf48aa34.js";import"./colors.1.sha256-e1fd46124e.js";import"./exports.1.sha256-e7ea12f564.js";import"./uikit.1.sha256-db4f9c9a42.js";/* empty css                              */import"./TextInput.1.sha256-8781e7c32f.js";import"./index.1.sha256-13a79a1060.js";import"./_curry1.1.sha256-6f4d2d935a.js";import"./isValidNumber.1.sha256-14234e8c86.js";import"./normalizeArguments.1.sha256-7bc6ca83b5.js";import"./react-select.esm.1.sha256-5741d9ea6d.js";import"./Select-54ac8379.esm.1.sha256-e6bf978cc3.js";import"./emotion-use-insertion-effect-with-fallbacks.browser.esm.1.sha256-eafa67ea3b.js";import"./createClass.1.sha256-de804af1ec.js";import"./toPropertyKey.1.sha256-a4b30e57f4.js";import"./typeof.1.sha256-340f9cdb42.js";import"./defineProperty.1.sha256-725b77c2f6.js";import"./memoize-one.esm.1.sha256-99dcd8935a.js";import"./util.1.sha256-ff4825489b.js";import"./get.1.sha256-efe98ad064.js";import"./_Map.1.sha256-effca63c03.js";import"./isObject.1.sha256-d68c67d6b7.js";import"./isSymbol.1.sha256-408b520cb0.js";import"./_MapCache.1.sha256-bad0a2a0da.js";import"./_baseSlice.1.sha256-b968445b29.js";import"./_baseIteratee.1.sha256-18af11ec63.js";import"./_baseIsEqual.1.sha256-2d606edfcf.js";import"./_getTag.1.sha256-286ee53a68.js";import"./styles.1.sha256-39b75b57ae.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},i=new t.Error().stack;i&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[i]="29936636-c044-423e-81d1-6a2da559154b",t._sentryDebugIdIdentifier="sentry-dbid-29936636-c044-423e-81d1-6a2da559154b")}catch{}const ht="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.66675%208.33333C5.75389%208.33333%205.00008%209.08714%205.00008%2010V30C5.00008%2030.9129%205.75389%2031.6667%206.66675%2031.6667H33.3334C34.2463%2031.6667%2035.0001%2030.9129%2035.0001%2030V10C35.0001%209.08714%2034.2463%208.33333%2033.3334%208.33333H6.66675ZM1.66675%2010C1.66675%207.24619%203.91294%205%206.66675%205H33.3334C36.0872%205%2038.3334%207.24619%2038.3334%2010V30C38.3334%2032.7538%2036.0872%2035%2033.3334%2035H6.66675C3.91294%2035%201.66675%2032.7538%201.66675%2030V10Z'%20fill='%23A09A93'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M1.96793%209.04417C2.49578%208.29009%203.535%208.1067%204.28908%208.63455L20%2019.6322L35.7109%208.63455C36.465%208.1067%2037.5042%208.29009%2038.032%209.04417C38.5599%209.79825%2038.3765%2010.8375%2037.6224%2011.3653L20.9558%2023.032C20.3819%2023.4337%2019.6181%2023.4337%2019.0442%2023.032L2.37754%2011.3653C1.62346%2010.8375%201.44007%209.79825%201.96793%209.04417Z'%20fill='%23A09A93'/%3e%3c/svg%3e",gt="data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M31.6679%2013.334H33.3339C36.1679%2013.334%2038.3339%2015.5%2038.3339%2018.334V26.668C38.3339%2029.502%2036.1679%2031.668%2033.3339%2031.668H31.6679V36.668C31.6679%2037.668%2031.0019%2038.334%2030.0019%2038.334H10.0019C9.00192%2038.334%208.33592%2037.668%208.33592%2036.668V31.668H6.66992C3.83592%2031.668%201.66992%2029.502%201.66992%2026.668V18.334C1.66992%2015.5%203.83592%2013.334%206.66992%2013.334H8.33592V3.33397C8.33592%202.33397%209.00192%201.66797%2010.0019%201.66797H30.0019C31.0019%201.66797%2031.6679%202.33397%2031.6679%203.33397V13.334ZM28.3319%204.99997H11.6659V13.334H28.3319V4.99997ZM28.3339%2035H11.6679V25H28.3339V35ZM33.3339%2028.332C34.3339%2028.332%2034.9999%2027.666%2034.9999%2026.666H35.0019V18.332C35.0019%2017.332%2034.3359%2016.666%2033.3359%2016.666H6.66992C5.66992%2016.666%205.00392%2017.332%205.00392%2018.332V26.666C5.00392%2027.666%205.66992%2028.332%206.66992%2028.332H8.33592V23.332C8.33592%2022.332%209.00192%2021.666%2010.0019%2021.666H30.0019C31.0019%2021.666%2031.6679%2022.332%2031.6679%2023.332V28.332H33.3339Z'%20fill='%23A09A93'/%3e%3c/svg%3e",xe=[R.USD,R.CAD],pt={[R.USD]:"US",[R.CAD]:"CA"},_t="https://static-prod.rinse.com/assets/bundles/us.1.sha256-c70902282c.svg",yt="data:image/svg+xml,%3csvg%20width='16'%20height='12'%20viewBox='0%200%2016%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_6656_2623)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M4%200H12V12H4V0Z'%20fill='%23F7FCFF'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M7.9882%203.50002L8%209.50002H7.70025L7.88416%208.01519C6.5391%208.25721%205.92216%208.31718%206.03336%208.19511C6.14456%208.07303%206.23218%207.90001%206.29623%207.67606L4.5%206.47767C4.68889%206.47531%204.86018%206.42842%205.01385%206.33703C5.16752%206.24563%205.09069%205.92892%204.78334%205.38689L5.69023%205.51883L6.03336%205.14593L6.7176%205.86205H7.02516L6.7176%204.22173L7.26891%204.52968L7.9882%203.50002ZM7.98808%203.5L8.73097%204.52966L9.28228%204.22171L8.97471%205.86203H9.28228L9.96652%205.14591L10.3096%205.51881L11.2165%205.38687C10.9092%205.9289%2010.8324%206.24561%2010.986%206.33701C11.1397%206.4284%2011.311%206.47528%2011.4999%206.47765L9.70365%207.67604C9.7677%207.89999%209.85532%208.07301%209.96652%208.19509C10.0777%208.31716%209.46078%208.25719%208.11572%208.01517L8.29963%209.5H7.99988L7.98808%203.5Z'%20fill='%23E31D1C'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M12%200H16V12H12V0Z'%20fill='%23E31D1C'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0%200H4V12H0V0Z'%20fill='%23E31D1C'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_6656_2623'%3e%3crect%20width='16'%20height='12'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",xt={},vt={US:_t,CA:yt};function Ct({code:t,...i}){return e.jsx("img",{src:vt[t],...i,className:I(xt.countryFlag,i.className)})}const Nt=Y.forwardRef(function({currencies:i=xe,styles:s,...a},n){const c=i.map(o=>({label:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx("div",{children:o})," ",e.jsx(Ct,{code:pt[o]})]}),value:o})),f=at("(min-width: 960px)");return e.jsx(st,{options:c,ref:n,styles:{...s,valueContainer:(o,r)=>({padding:"12px 0 12px 12px",justifyItems:"center",...s?.valueContainer?.(o,r)}),control:(o,r)=>({height:"unset",justifyContent:"center",...s?.control?.(o,r)}),singleValue:(o,r)=>({fontWeight:"400",...s?.singleValue?.(o,r)}),dropdownIndicator:(o,r)=>({padding:`0 ${f?"12px":"8px"} 0 0`,...s?.dropdownIndicator?.(o,r)})},...a})});function jt({control:t,name:i,...s}){return e.jsx(rt,{name:i,control:t,render:({field:a,fieldState:n})=>e.jsx(Nt,{name:i,...a,...n,...s})})}var y=(t=>(t.EMAIL="Email",t.PRINT="Print",t))(y||{});const bt="_columns_1amh5_6",wt="_amountChoices_1amh5_21",St="_giftAmountChoice_1amh5_37",Rt="_customAmountChoice_1amh5_59",Mt="_customAmountInput_1amh5_68",At="_deliveryMethodChoices_1amh5_72",kt="_choiceDeliveryMethodLabel_1amh5_88",Et="_deliveryMethodChoice_1amh5_72",Ft="_fromAndSenderFields_1amh5_117",It="_firstName_1amh5_134",Lt="_lastName_1amh5_137",Tt="_createGiftCardButton_1amh5_141",Gt="_paymentFields_1amh5_145",Dt="_headingGiftAmount_1amh5_149",Vt="_currencySelector_1amh5_156",m={columns:bt,amountChoices:wt,giftAmountChoice:St,customAmountChoice:Rt,customAmountInput:Mt,deliveryMethodChoices:At,choiceDeliveryMethodLabel:kt,deliveryMethodChoice:Et,fromAndSenderFields:Ft,firstName:It,lastName:Lt,createGiftCardButton:Tt,paymentFields:Gt,headingGiftAmount:Dt,currencySelector:Vt},U="Custom",Ht=[{value:"50"},{value:"100"},{value:"200"},{value:U,classNames:[m.customAmountChoice]}],$t=[{value:y.EMAIL,label:"Email",icon:ht},{value:y.PRINT,label:"Print at home",icon:gt}];function Pt(t){const i=F({amount:"20",currency:t},0),s=F({amount:"1000",currency:t},0),a=`between ${i} and ${s}`;return ye().shape({radioAmount:ct(n=>typeof n=="number"?$():E()),amountCurrency:nt().oneOf([...xe]),customGiftAmount:$().when("radioAmount",{is:"Custom",then:$().typeError(`Please enter a valid amount ${a}`).max(1e3,`Sorry, we only accept amounts ${a}`).min(20,`Sorry, we only accept amounts ${a}`).integer("Please round your gift amount to the nearest dollar").required("Please enter the value you would like to gift"),otherwise:$().notRequired().transform(()=>0)}),radioDelivery:E(),senderFirstName:H.required("Your first name is required"),senderLastName:H.required("Your last name is required"),senderEmail:ue.required("Your email is required"),giftMessage:E().trim(),recipientFirstName:H.required("First name is required."),recipientLastName:H.required("Last name is required."),recipientEmail:E().when("radio_delivery",{is:y.EMAIL,then:ue.required("Email is required")})})}const Bt=()=>{const t=Ve(),i=document.getElementById("preview__message");i&&(t>=480&&i.offsetHeight>66?i.style.fontSize="14px":t<480&&i.offsetHeight>66?i.style.fontSize="12px":(t>=480&&i.offsetHeight<=63||t<480&&i.offsetHeight<=54)&&(i.style.fontSize="0.85rem"));const s=document.getElementById("preview__name");s&&(t>=480&&s.offsetHeight>44?s.style.fontSize="14px":t<480&&s.offsetHeight>44?s.style.fontSize="12px":(t>=480&&s.offsetHeight<=42||t<480&&s.offsetHeight<=36)&&(s.style.fontSize="0.85rem"))},qt=({customerData:t})=>{const{first_name:i,last_name:s,email:a,existing_cc_details:n}=t??{},c=!!t,f=P("is_authenticated"),o=P("call_cx_number"),r="give-form",d=We(),l=Ye(),g=dt(),p=async u=>{const{giftMessage:b,radioAmount:w,radioDelivery:G,customGiftAmount:ke,senderEmail:Ee,senderFirstName:se,senderLastName:Fe,recipientEmail:Ie,recipientFirstName:ae,recipientLastName:Le,amountCurrency:re}=u,oe=w==="Custom"?ke:w,ne=G,ce={giftMessage:b,amount:oe,amountCurrency:re,deliveryMethod:ne,senderEmail:Ee,senderFirstName:se,senderLastName:Fe,recipientEmail:Ie,recipientFirstName:ae,recipientLastName:Le};if(!d||!l){console.error("Stripe not yet loaded.");return}if(!n){const{error:A,setupIntent:D}=await d.confirmSetup({elements:l,redirect:"if_required",confirmParams:{return_url:window.location.toString()}});if(A){console.error(A),k(`${A.message} Please try again or call us toll free at ${o}.`,V.Danger);return}ce.setupIntentId=D.id}try{await et.post("/gifts/create/",ce),g.push("/success/",{senderFirstName:se,recipientFirstName:ae,amount:oe,amountCurrency:re,deliveryMethod:ne})}catch(A){const D=A.response.data.detail;D==="charge_failed"?k(`Credit card charge failed. Please try again or call us toll free at ${o}.`,V.Danger):D==="credit_card_verification_failed"?k(`Credit card verification failed. Please try again or call us toll free at ${o}.`,V.Danger):k('Oops! Something went wrong on our end. Please try again later or contact <a href="mailto:care@rinse.com" class="link--underline">care@rinse.com</a> for assistance.',V.Danger)}},{handleSubmit:_,control:h,formState:{isSubmitting:C,isValidating:K,isValid:L,errors:N},setValue:q,watch:j}=ot({resolver:(u,b,w)=>Qe(Pt(u.amountCurrency))(u,b,w),defaultValues:{radioAmount:"50",customGiftAmount:"",amountCurrency:R.USD,radioDelivery:y.EMAIL,senderFirstName:i||"",senderLastName:s||"",senderEmail:a||"",giftMessage:"",recipientFirstName:"",recipientLastName:"",recipientEmail:""}}),{grecaptchaRef:Ce,resetRecaptcha:J}=it(r);x.useEffect(()=>{if(!L&&!C){const u=document.querySelector("#form--gifts .error");u&&Ge(u,-150)}},[C,L]),x.useEffect(()=>{!L&&!K&&C&&J()},[L,K,C,J]),x.useEffect(()=>{q("senderEmail",a),q("senderFirstName",i||""),q("senderLastName",s||"")},[a,i,s]);const M=j("radioAmount"),X=x.useRef(null);x.useEffect(()=>{M==="Custom"&&X.current&&X.current.focus()},[M]);const T=j("radioDelivery"),Ne=j("customGiftAmount"),je=j("giftMessage"),be=j("recipientFirstName"),we=j("recipientLastName"),Q=j("amountCurrency"),Se=T===y.EMAIL?"We’ll send a digital gift card directly to the recipient.":"You’ll receive an email with the gift card in a PDF that you can easily print.",O=M===U?Ne:Number(M),Re=O?`Gift a ${F({amount:O.toString(),currency:Q},0)} Rinse Gift Card`:"Gift a Rinse Gift Card",W=T===y.EMAIL?"digital":"print",Me=T===y.EMAIL?"Digital":"Printed";let ee=!1;t?.existing_cc_details&&(ee=!0);const te=!f||c&&!ee;Bt();const Ae=()=>{grecaptcha.execute(Ce.current)},ie=De();return e.jsxs("form",{id:r,className:"gifts-form gifts-form--give",noValidate:!0,onSubmit:_(p),children:[e.jsxs("div",{className:m.columns,children:[e.jsxs("div",{className:"gifts-form__fieldset",role:"group","aria-labelledby":"heading--gift-amount",children:[e.jsxs("h2",{id:"heading--gift-amount",className:I("heading heading--medium heading--gifts",m.headingGiftAmount),children:[e.jsx("div",{children:"Gift a Rinse Card"}),e.jsx(jt,{label:"Currency",name:"amountCurrency",control:h,showLabel:!1,className:m.currencySelector})]}),e.jsxs("fieldset",{children:[e.jsx("legend",{className:"sr-only",children:"Choose a gift amount"}),e.jsxs("div",{className:m.amountChoices,children:[Ht.map((u,b)=>e.jsx(de,{id:`amount_choice--${b}`,label:Number.isNaN(+u.value)?u.value:`$${u.value}`,control:h,hideInputComponent:!0,type:le.Radio,name:"radioAmount",className:I(m.giftAmountChoice,...u.classNames??[]),value:u.value,testId:`amount-choice--${u.value}`},u.value)),M===U&&e.jsx(S,{control:h,name:"customGiftAmount",label:"Enter dollar amount (min $20)",inputType:"number",maxLength:4,ref:X,className:m.customAmountInput,testId:"amount-choice--custom"})]}),e.jsx("p",{className:"gifts-form__desc",children:"Rinse credits can be used for any Rinse service, like Dry Cleaning and Wash & Fold, and never expire."})]})]}),e.jsxs("div",{className:"gifts-form__fieldset",role:"group","aria-labelledby":"heading-gifts--delivery",children:[e.jsx("h2",{id:"heading-gifts--delivery",className:"heading heading--medium heading--gifts",children:"Delivery Method"}),e.jsxs("fieldset",{children:[e.jsx("div",{className:m.deliveryMethodChoices,children:$t.map(({icon:u,label:b,value:w},G)=>e.jsx(de,{id:`delivery_choice--${G}`,control:h,type:le.Radio,label:e.jsxs("div",{className:m.choiceDeliveryMethodLabel,children:[e.jsx("img",{src:u,alt:""})," ",b]}),name:"radioDelivery",value:w,hideInputComponent:!0,className:m.deliveryMethodChoice,testId:`delivery-choice--${w}`},`delivery-${G}`))}),e.jsx("p",{id:"delivery-method-desc",className:"gifts-form__desc",children:Se})]})]}),e.jsxs("div",{role:"group","aria-labelledby":"heading--gift-sender-details",className:"gifts-form__fieldset",children:[e.jsx("h2",{id:"heading--gift-sender-details",className:"heading heading--medium heading--gifts",children:"From"}),e.jsxs("fieldset",{className:m.fromAndSenderFields,children:[e.jsx("legend",{className:"sr-only",children:"Your information"}),e.jsx(S,{control:h,name:"senderFirstName",label:"Your first name",maxLength:30,autoComplete:"given-name",className:m.firstName,validationMessage:N.senderFirstName?.message,showErrorWithoutTouch:!0,testId:"sender-first-name-input"}),e.jsx(S,{control:h,name:"senderLastName",label:"Your last name",maxLength:30,autoComplete:"family-name",className:m.lastName,validationMessage:N.senderLastName?.message,showErrorWithoutTouch:!0,testId:"sender-last-name-input"}),!t?.email&&e.jsx(me,{control:h,name:"senderEmail",label:"Your email",autoComplete:"email",inputType:ie,validationMessage:N.senderEmail?.message,showErrorWithoutTouch:!0,testId:"sender-email-input"}),e.jsx(S,{control:h,name:"giftMessage",label:"Message (optional - up to 120 characters)",maxLength:120,inputType:"text",validationMessage:N.giftMessage?.message,showErrorWithoutTouch:!0,testId:"gift-message-input"})]})]}),e.jsxs("div",{role:"group",className:"gifts-form__fieldset","aria-labelledby":"heading--gift-recipient-details",children:[e.jsx("h2",{id:"heading--gift-recipient-details",className:"heading heading--medium heading--gifts",children:"Recipient"}),e.jsx("fieldset",{className:"gifts-form__fieldset",children:e.jsxs("div",{className:m.fromAndSenderFields,children:[e.jsx(S,{control:h,name:"recipientFirstName",label:"First name",maxLength:30,autoComplete:"recipient-first-name",className:m.firstName,validationMessage:N.recipientFirstName?.message,showErrorWithoutTouch:!0,testId:"recipient-first-name-input"}),e.jsx(S,{control:h,name:"recipientLastName",label:"Last name",maxLength:30,autoComplete:"recipient-last-name",className:m.lastName,validationMessage:N.recipientLastName?.message,showErrorWithoutTouch:!0,testId:"recipient-last-name-input"}),T===y.EMAIL&&e.jsx(me,{control:h,name:"recipientEmail",label:"Email",inputType:ie,validationMessage:N.recipientEmail?.message,showErrorWithoutTouch:!0,testId:"recipient-email-input"})]})})]})]}),e.jsxs("div",{className:m.columns,children:[e.jsxs("div",{className:`gifts-form__fieldset gifts-form__preview gifts-form__preview--${W}`,role:"group","aria-label":"Gift card preview",children:[e.jsx("h2",{className:"heading heading--medium heading--gifts heading--gifts--preview",children:`${Me} Gift Card`}),e.jsxs("figure",{className:`preview__image preview__image--${W}`,children:[W==="digital"&&e.jsx("span",{id:"preview__message",className:"preview__text preview__message","data-testid":"preview-message",children:je}),e.jsx("span",{id:"preview__name",className:"preview__text preview__name","data-testid":"preview-name",children:`${be} ${we}`}),e.jsx("span",{id:"preview__amount",className:"preview__text preview__amount","data-testid":"preview-amount",children:F({amount:O.toString(),currency:Q},0)})]})]}),e.jsxs("fieldset",{className:"gifts-form__fieldset gifts-form__fieldset--payment-info uk-flex-first@m",children:[te?e.jsxs("div",{className:m.paymentFields,children:[e.jsx("legend",{children:e.jsx("h2",{className:"heading heading--medium heading--gifts",children:"Payment Info"})}),te&&e.jsx(Ze,{})]}):e.jsx("legend",{className:"sr-only",children:"Complete your gift card purchase"}),e.jsx("div",{id:`${r}-recaptcha`}),e.jsx("input",{id:`${r}-hidden-input--recaptcha-token`,type:"hidden"}),e.jsx("button",{id:`${r}-hidden-submit`,style:{display:"none"},"aria-hidden":"true",type:"submit"}),e.jsx(v,{as:"button",variation:B.Primary,id:"gifts__button--purchase-gift",className:m.createGiftCardButton,disabled:C,onClick:Ae,type:"button",testId:"give-form-submit-button",children:C?"Submitting...":Re}),e.jsxs("p",{className:"gifts-form__p gifts-form__p--note",children:["A receipt will be"," ",t?.email?"sent to your Rinse account email":"emailed to you","."]})]})]})]})},Xt="_redeemButton_thgjk_6",Ot={redeemButton:Xt},Wt=t=>{const{handleFormSubmit:i,isStandaloneForm:s,formikProps:a}=t,{isSubmitting:n,setFieldValue:c}=a,f=o=>{let r=o.currentTarget.value,d="";if(r){r=r.replace(/[\W\s._-]+/g,"");let l=2;const g=[],p=r.length===10?4:5;for(let _=0,h=r.length;_<h;_+=l)l=_<2?2:p,g.push(r.substr(_,l));d=g.join("-").toUpperCase()}c("gift_card_code",d)};return e.jsx("form",{id:"form--gifts",className:I("gifts-form gifts-form--redeem",s&&"gifts-form--redeem--standalone"),noValidate:!0,onSubmit:i,children:e.jsx("section",{className:I("gifts-form__grid gifts-form__grid--redeem","uk-grid uk-child-width-1-1",!s&&"uk-child-width-1-2@m"),"data-uk-grid":!0,children:e.jsxs("fieldset",{className:"gifts-form__fieldset",children:[s?e.jsx("legend",{className:"sr-only",children:"Redeem a Rinse Gift Card"}):e.jsx("legend",{children:e.jsx("h2",{className:"nowrap heading heading--medium heading--gifts",children:"Redeem a Rinse Gift Card"})}),e.jsx(ut,{id:"gift_card_code",iconType:"lock",inputType:"text",maxLength:"14",name:"gift_card_code",label:"RG   - - - - -   - - - - -",customHandleChange:f,formikProps:a}),e.jsx(v,{as:"button",id:"gifts__button--redeem-code",type:"submit",disabled:n,variation:B.Primary,className:Ot.redeemButton,children:n?"Submitting...":"Redeem my Rinse Gift Card"})]})})})},Yt=t=>{const i=C=>{z.set("gift_card_code",t.submittedCode),window.location.href="/customers/signup/"},{closeModal:s,giftAmount:a,id:n,responseStatus:c,showModal:f}=t,o=c==="invalid",r=c==="already_redeemed",d=c==="not-logged-in",l=c==="campaign_redeemed",g=P("sms_cx_number"),p=a?"Hooray!":o||r||l?"Oops!":d?"Redeem your gift":"",_=a?e.jsxs(e.Fragment,{children:[`You’ve successfully redeemed your gift card. $${Number(a)} of credit has been added to your account and can be applied to any Rinse service. To use your credit just schedule a pickup via Rinse.com, the Rinse mobile app, or by texting “Y” to ${g}${g==="746-73"?' ("RINSE")':""}. If you have any questions, please reach out to `,e.jsx("a",{href:"mailto:care@rinse.com",className:"link--primary link--underline",children:"care@rinse.com"}),"."]}):o?e.jsxs(e.Fragment,{children:["Invalid gift card redemption code. Be sure to enter your 10-digit or 12-digit code exactly as it appears. If you continue to have trouble redeeming your Rinse Gift Card, please contact"," ",e.jsx("a",{href:"mailto:care@rinse.com",className:"link--primary link--underline",children:"care@rinse.com"}),"."]}):r?e.jsxs(e.Fragment,{children:["Looks like you have already redeemed this Rinse Gift Card. If you have questions or need assistance, please contact"," ",e.jsx("a",{href:"mailto:care@rinse.com",className:"link--primary link--underline",children:"care@rinse.com"}),"."]}):d?e.jsx(e.Fragment,{children:"To redeem your Rinse gift card, please first log in to your Rinse account or create one for free. Once you’re logged in, you can return to this page and enter your unique redemption code."}):l?e.jsxs(e.Fragment,{children:["Our records indicate that you have already redeemed a credit from a card received via this campaign. If you have questions or need assistance, please contact"," ",e.jsx("a",{href:"mailto:care@rinse.com",className:"link--primary link--underline",children:"care@rinse.com"}),"."]}):null,h=a?e.jsx(v,{as:"a",className:"gifts-modal__button",id:"gifts-modal__button--got-it",href:"/customers/account/",children:"Got it, thanks!"}):o||r||l?e.jsx(v,{as:"button",className:"gifts-modal__button",onClick:s,id:"gifts-modal__button--got-it",children:"Got it, thanks!"}):d?e.jsx(v,{as:"button",className:"gifts-modal__button",onClick:i,id:"gifts-modal__button--sign-up",children:"Create a Rinse account"}):null;return e.jsxs(ft,{classes:{modal:"gifts-modal",mediaTopWrapper:"gifts-modal__media-top-wrapper",content:a&&"gifts-modal__content--success"},closeModal:s,id:n,mediaTop:a&&e.jsx("figure",{className:"gifts-modal__image"}),showModal:f,title:p,children:[_&&e.jsx("p",{children:_}),a&&e.jsx("p",{children:"Thank you for choosing Rinse."}),h,d&&e.jsx(v,{as:"a",className:"gifts-modal__button",id:"gifts-modal__button--log-in",href:"/accounts/login/?next=/gifts/redeem/",variation:B.Secondary,children:"Log in"})]})};class Zt extends x.Component{constructor(i){super(i),this.state={redeemedGiftAmount:null,responseStatus:null,showRedeemModal:!1}}openRedeemModal=()=>{this.setState({showRedeemModal:!0})};closeRedeemModal=()=>{this.setState({showRedeemModal:!1})};handleFormSubmit=i=>{tt(),He();const{postDataToServer:s,...a}=this.props,{handleSubmit:n,setSubmitting:c,values:f,errors:o,setFieldValue:r,setFieldTouched:d}=a;if(n(i),Object.keys(o).length){i.preventDefault(),c(!1);return}s({url:"/gifts/redeem-gift/",data:{gift_code:f.gift_card_code.replace(/-/g,"")},onSuccess:l=>{c(!1),z.remove("gift_card_code"),sessionStorage.removeItem("gift_card_code"),d("gift_card_code",!1),r("gift_card_code","");const g=l.data.amount;this.setState({redeemedGiftAmount:g,responseStatus:"valid"},()=>{this.openRedeemModal()})},onError:l=>{c(!1);const g=l.response.status,p=l.response.data.message;p==="already_redeemed"||p==="campaign_redeemed"||p==="invalid"?this.setState({redeemedGiftAmount:null,responseStatus:p},()=>{this.openRedeemModal()}):g===401?($e("gift_card_code",f.gift_card_code),this.setState({redeemedGiftAmount:null,responseStatus:"not-logged-in"},()=>{this.openRedeemModal()})):k('Oops! Something went wrong on our end. Please try again later or contact <a href="mailto:care@rinse.com" class="link--underline">care@rinse.com</a> for assistance.',"danger")}})};render(){const{isStandaloneForm:i,...s}=this.props,{redeemedGiftAmount:a,responseStatus:n,showRedeemModal:c}=this.state;return e.jsxs(e.Fragment,{children:[e.jsx(Wt,{handleFormSubmit:this.handleFormSubmit,redeemedGiftAmount:a,responseStatus:n,isStandaloneForm:i,formikProps:s}),e.jsx(Yt,{closeModal:this.closeRedeemModal,giftAmount:a,id:"gifts-redeem-modal",responseStatus:n,showModal:c,submittedCode:s.values.gift_card_code})]})}}const ve=mt({mapPropsToValues:()=>({gift_card_code:Pe("gift_card_code")||""}),validationSchema:ye().shape({gift_card_code:E().test({name:"giftcardformat",message:"Your code should be 10 or 12 alphanumeric characters, RG-XXXXX-XXXXX or RG-XXXX-XXXX",test:t=>/^([A-Z0-9]{10}|[A-Z0-9]{12})$/i.test(t&&t.replace(/-/g,""))}).required("Enter your gift card code to redeem your credit")}),handleSubmit:(t,{props:i,setSubmitting:s})=>{}})(Zt),Ut="_heroButtons_v4k0w_6",zt="_heroTextContent_v4k0w_14",ge={heroButtons:Ut,heroTextContent:zt},Kt=()=>{const t=P("STRIPE_PUBLISHABLE_KEY"),i=x.useMemo(()=>Ue(t),[t]),[s,a]=Y.useState(null),[n,c]=Y.useState(null);he(()=>{(async()=>{const d=await Je();c(d)})()});const f=async()=>{const l=(await Z({method:"get",url:"/customers/account/",headers:{"X-Requested-With":"XMLHttpRequest"}})).data.customer;a(l)};he(()=>{f(),_e("Gifts")});const o={clientSecret:n,appearance:Ke({})},r=({method:d,url:l,data:g,onSuccess:p,onError:_})=>{d||(d="POST"),Z({method:d,url:l,data:g,headers:Be()}).then(p).catch(_)};return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"section section--vert-padding-large content-media-block hero hero--gifts","data-background-color":"white","data-section-id":"gifts-hero",children:[e.jsx("div",{className:"content-media-block__media-block",children:e.jsx("figure",{className:"content-media-block__media content-media-block__media--gifts"})}),e.jsxs("div",{className:ge.heroTextContent,children:[e.jsx("h2",{className:"superheading",children:"Rinse Gift Cards"}),e.jsx("h1",{className:"hero__title hero__title--gifts",children:"The only gift that cleans & delivers."}),e.jsx("p",{className:"hero__subtitle hero__subtitle--gifts",children:"Giving Rinse is like gifting free time to your loved ones!"}),e.jsxs("div",{className:ge.heroButtons,children:[e.jsx(v,{as:"a",href:"#gifts__section--give",children:"Gift a Rinse Gift Card"}),e.jsx(v,{as:"a",href:"#gifts__section--redeem",variation:B.Secondary,children:"Redeem a gift card"})]})]})]}),e.jsxs("section",{className:"section section--gifts--redeem-form","data-background-color":"white",children:[e.jsx("div",{id:"gifts__section--redeem",className:"section__bookmark"}),e.jsx(ve,{postDataToServer:r})]}),n&&e.jsx(ze,{stripe:i,options:o,children:e.jsxs("section",{className:"section section--gifts--give-form","data-background-color":"white",children:[e.jsx("div",{id:"gifts__section--give",className:"section__bookmark"}),e.jsx(qt,{customerData:s})]})},n)]})},Jt=t=>{const i=t.location?.state??{senderFirstName:"",recipientFirstName:"",amount:"0",deliveryMethod:"",amountCurrency:R.USD},{senderFirstName:s,recipientFirstName:a,amount:n,amountCurrency:c,deliveryMethod:f}=i,o=F({amount:n.toString(),currency:c},0),r=f===y.EMAIL?e.jsx("p",{className:"gifts-success__p",children:`Your payment of ${o} has been processed and your gift of ${o} for Rinse services will be delivered to ${a}’s email. You will also receive a receipt by email.`}):e.jsxs("p",{className:"gifts-success__p",children:[`You’ll receive an email with your ${o} Rinse Gift Card in a PDF that you can easily print. If you don’t receive an email within 24 hours or have any questions, please contact `,e.jsx("a",{href:"mailto:care@rinse.com",className:"link--primary link--underline gifts-modal__link",children:"care@rinse.com"}),"."]});return e.jsx("div",{className:"main__wrapper--no-hero uk-text-left",children:e.jsxs("section",{className:"section section--hero","data-section-id":"gifts-hero",children:[e.jsx("h1",{className:"hero__title hero__title--gifts-success",children:"Your gift is on its way"}),e.jsxs("p",{className:"gifts-success__p",children:["Thank you ",s,"!"]}),r,e.jsx("p",{className:"gifts-success__p",children:"Thank you for choosing Rinse."}),e.jsx("figure",{className:"gifts_success__image--confetti"})]})})},Qt=()=>e.jsx(Xe,{basename:"/gifts",children:e.jsx(Oe,{children:e.jsxs(lt,{children:[e.jsx(fe,{path:"/",exact:!0,component:Kt}),e.jsx(fe,{path:"/success/",component:Jt})]})})});class ei extends x.Component{componentDidMount=()=>{_e("Gifts Redeem")};postDataToServer=({method:i,url:s,data:a,onSuccess:n,onError:c})=>{i||(i="POST");const f=z.get("csrftoken");Z({method:i,url:s,data:a,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-CSRFToken":f}}).then(n).catch(c)};render(){return e.jsx(e.Fragment,{children:e.jsxs("section",{className:"section section--vert-padding-large content-media-block content-media-block--align-left hero hero--gifts",children:[e.jsx("div",{className:"content-media-block__media-block content-media-block__media-block--gifts--redeem",children:e.jsx("figure",{className:"content-media-block__media content-media-block__media--gifts"})}),e.jsxs("div",{className:"content-media-block__text-block",children:[e.jsx("h3",{className:"superheading",children:"Rinse Gift Cards"}),e.jsx("h1",{className:"hero__title hero__title--gifts",children:"Redeem a Rinse Gift Card"}),e.jsx(ve,{isStandaloneForm:!0,postDataToServer:this.postDataToServer})]})]})})}}document.getElementById("gifts__container")&&pe.render(e.jsx(Qt,{}),document.getElementById("gifts__container"));document.getElementById("gifts-redeem__container")&&pe.render(e.jsx(ei,{}),document.getElementById("gifts-redeem__container"));qe(()=>{Te()});
//# sourceMappingURL=gifts.1.sha256-be67e7f6f7.js.map
