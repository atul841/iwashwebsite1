import{j as N,b as E,k,w as x,M as H,x as y}from"./utils.1.sha256-9ee1c54c60.js";import{s as oe,i as ae}from"./videos.1.sha256-4dab69a5b8.js";import"./internal_customer_edit_inner.1.sha256-34481b9084.js";import{R as P,r as F,j as o,a as re}from"./index.1.sha256-491025a480.js";import{o as se}from"./yup.1.sha256-7565e34740.js";import{c as w}from"./index.1.sha256-2204be5363.js";import{a as ie}from"./js.cookie.1.sha256-b274c81169.js";import{u as ce}from"./index.esm.1.sha256-6f50330ddf.js";import{a as W}from"./array.1.sha256-899a6845d3.js";import{R as ue}from"./RinseButton.1.sha256-31aa4971bc.js";import{D as le}from"./index.1.sha256-f7724c6ecf.js";import{s as de,A as pe}from"./notifications.1.sha256-22ce999815.js";import{a as q,S as $,t as me,F as he,j as fe,k as be}from"./tracking.1.sha256-c760b2e67b.js";import{e as ge,p as ye}from"./validation.1.sha256-5c3897149a.js";import{s as _e,b as Se,c as Ce}from"./LandingForm.1.sha256-10624e9ea6.js";import{u as v}from"./dataHooks.1.sha256-3888564008.js";import{f as B,b as G}from"./stringUtils.1.sha256-2be81a19c5.js";import{E as Te}from"./EmailInputController.1.sha256-47b4940056.js";import{P as Ie}from"./PhoneNumberInputController.1.sha256-bfc3fe20b4.js";import{u as M}from"./useEffectOnce.1.sha256-ede3d12bd3.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="616d487d-95b1-4236-9d08-e03c0568a3eb",e._sentryDebugIdIdentifier="sentry-dbid-616d487d-95b1-4236-9d08-e03c0568a3eb")}catch{}const U=5e3,Ee="splash--rinse",we=600,xe=800,Pe=()=>{document.body.style.overflow="hidden"},Ne=()=>{document.body.style.overflow=null},bt=()=>{const e=document.getElementById(Ee);if(e){Pe();const t=()=>{N(e),Ne()},a=setTimeout(()=>{t()},U),n=()=>{Array.from(document.querySelectorAll(".splash-transform-transition, .splash-cta-width-transition")).forEach(r=>{r.style.transform=null,r.style.width=null,r.style.minWidth=null})};let i;matchMedia("(prefers-reduced-motion: reduce)").matches?n():i=setTimeout(()=>{n()},U-xe);const m=document.getElementById("splash-video");return m&&setTimeout(async()=>{try{await oe(m)}catch{clearTimeout(a),clearTimeout(i),n(),t()}},we),!0}return!1},je="https://static-prod.rinse.com/assets/bundles/wash-fold-bag-kitchen.1.sha256-cc45ccaa24.webp";var Le=(e=>(e.Home="home",e.Landing="landing",e))(Le||{});const ve=({email:e,phoneNumber:t})=>{const n=`/customers/signup/?${e?`email_address=${encodeURIComponent(e)}`:`phone_number=${encodeURIComponent(t)}`}`,i=document.querySelectorAll('[data-go-to-login="header"]'),u=document.querySelectorAll('[data-go-to-login="offcanvas"]'),m=document.querySelectorAll("[data-schedule-pickup-cta]");i.forEach(r=>{r.innerText="Finish Sign Up",r.href=n}),u.forEach(r=>{const f=r.querySelector(".nav-offcanvas__label");f&&(f.innerText="Finish Sign Up"),r.href=n}),m.forEach(r=>{r.href=n})},ke=()=>{const e=E("lead_capture_discount_amount"),t=E("lead_capture_discount_percentage"),a=E("lead_capture_discount_applicable_per_order"),n=E("lead_capture_discount_order_count");return{discountAmount:e,discountApplicablePerOrder:a,discountOrderCount:n,discountPercentage:t}},Q=e=>{const{discountAmount:t,discountPercentage:a}=e;return t?B(t,0):`${G(a)}%`},gt=()=>{const e=document.querySelector("[data-email-input-wrapper]");N(e);const t=document.querySelector("[data-email-input-replacement-button]");k(t)},Re="_button_1ryji_6",Ae="_buttonSecondary_1ryji_10",De="_content_1ryji_14",Oe="_filledCheckIcon_1ryji_23",Fe="_form_1ryji_32",We="_heading_1ryji_36",qe="_imageTopWrapper_1ryji_42",$e="_mainContent_1ryji_51",Me="_modal_1ryji_58",Ue="_p_1ryji_62",Ve="_phoneNumberDisclaimer_1ryji_69",He="_subheading_1ryji_76",s={button:Re,buttonSecondary:Ae,content:De,filledCheckIcon:Oe,form:Fe,heading:We,imageTopWrapper:qe,mainContent:$e,modal:Me,p:Ue,phoneNumberDisclaimer:Ve,subheading:He},Be=(e,t)=>{const{discountApplicablePerOrder:a,discountOrderCount:n}=e;if(a&&n){const i=B(a,0),u=G(n);return{headingText:`Get ${i} Off`,subheadingText:`your first ${u} orders`}}return{headingText:`Get ${t} Off`,subheadingText:"your first order"}},Ge=({closeModal:e,discountInfo:t,id:a,onLeadEntryCaptured:n,page:i,showModal:u})=>{const r=v("is_in_sms_lead_capture_treatment_group")?"phone_number":"email",f=r==="email",h=r==="phone_number";P.useEffect(()=>{u&&q($.LeadCapturePopupShown,{input_type:r,page_type:i})},[r,i,u]);const _=v("lead_capture_campaign_code"),j=v("lead_capture_campaign_image_url"),l=Q(t),{headingText:b,subheadingText:S}=Be(t,l),[d,p]=F.useState(!1),[g,C]=F.useState(!1),T=P.createRef(),z=W().shape({email:ge.required("Please enter your email address")}),J=W().shape({phone_number:ye.required("Please enter your phone number")}),Y=f?z:J,{control:R,formState:K,handleSubmit:X,setError:A,watch:D}=ce({mode:"onSubmit",resolver:se(Y)}),Z=async c=>{c.email&&_e(c.email),c.phone_number&&Se(c.phone_number);let L=!1;try{const I=!!c.phone_number;await Ce({email:c.email,phoneNumber:c.phone_number},_,I),L=!0,c.email&&x("newLeadEmail",c.email),c.phone_number&&x("newLeadPhoneNumber",c.phone_number)}catch(I){if(I.response.data.email)A("email",{type:"custom",message:"Looks like you’re already a Rinse customer."}),p(!0);else if(I.response.data.phoneNumber)A("phone_number",{type:"custom",message:"Looks like you’re already a Rinse customer."}),p(!0);else{de('Oops! Something went wrong on our end. Please try again later or contact <a href="mailto:care@rinse.com" class="link--underline">care@rinse.com</a> for assistance.',pe.Danger);return}}n?.(),q($.LeadCapturePopupSubmitted,{customer_already_exists:!L,email:c.email,page_type:i,phone_number:c.phone_number}),me(he.CustomerLeadSubmitted),fe(be.LeadCapturePopupSubmitted),L&&(ie.set("campaign_code",_),C(!0))},{isSubmitting:ee}=K,O=D("email"),te=D("phone_number"),ne=`/customers/signup/?${O?`email_address=${encodeURIComponent(O)}`:`phone_number=${encodeURIComponent(te)}`}`;return o.jsx(le,{ariaLabel:`Submit your ${f?"email address":"phone number"} to claim your discount`,classes:{content:s.content,mediaTopWrapper:s.imageTopWrapper,modal:s.modal},closeModal:e,"data-testid":"lead-capture-modal",id:a,mediaTop:j||je,showModal:u,children:o.jsx("div",{className:s.mainContent,children:g?o.jsxs(o.Fragment,{children:[o.jsxs("h2",{className:s.heading,"data-testid":"lead-capture-popup-heading",children:[o.jsx("span",{className:w(s.filledCheckIcon,"rinse-icon","rinse-icon--filled-check"),"aria-hidden":"true"}),"Thanks!"]}),o.jsxs("p",{className:s.p,children:["Your ",o.jsxs("strong",{className:"span--bold",children:[l," credit"]})," will be automatically added once you finish creating your account using the same"," ",f?"email address":"phone number","."]}),o.jsx("a",{className:w("rinse-button--primary-new","rinse-button--primary-new--teal",s.button),href:ne,role:"button",children:"Finish creating account"}),o.jsx("button",{className:w("rinse-button--secondary-new",s.button,s.buttonSecondary),"data-testid":"lead-capture-popup-finish-later-button",onClick:e,type:"button",children:"I’ll finish later"})]}):o.jsxs(o.Fragment,{children:[o.jsx("h2",{className:s.heading,"data-testid":"lead-capture-popup-heading",children:b}),o.jsx("p",{className:s.subheading,children:S}),o.jsxs("form",{className:s.form,noValidate:!0,onSubmit:X(Z),children:[f?o.jsx(Te,{control:R,defaultValue:"",extraHandleChange:()=>p(!1),label:"Email address",name:"email",responsive:!0,ref:T,showErrorWithoutTouch:!0,testId:"lead-capture-popup-input"}):o.jsx(Ie,{control:R,defaultValue:"",extraHandleChange:()=>p(!1),label:"Mobile phone number",name:"phone_number",responsive:!0,ref:T,showErrorWithoutTouch:!0,testId:"lead-capture-popup-input"}),h&&o.jsxs("p",{className:s.phoneNumberDisclaimer,children:["By submitting your phone number here, you agree to receive marketing auto-sent texts from Rinse. Consent is not a condition of purchase. Text STOP or CANCEL anytime to opt out. Message & data rates may apply."," ",o.jsx("a",{href:"/terms-of-use/",target:"_blank","aria-label":"Rinse Terms of use — opens in a new tab",className:"link--primary signup-link",children:"Terms"})," ","and"," ",o.jsx("a",{href:"/privacy/",target:"_blank","aria-label":"Rinse Privacy Policy — opens in a new tab",className:"link--primary signup-link",children:"Privacy Policy"}),"."]}),d?o.jsx(ue,{as:"a",className:s.button,href:"/accounts/login/",children:"Log in"}):o.jsxs("button",{className:w("rinse-button--primary-new","rinse-button--primary-new--teal",s.button),"data-testid":"lead-capture-popup-submit-button",disabled:ee,type:"submit",children:["Claim your ",l," credit"]})]})]})})})},Qe=e=>{k(e);const t=e.closest("li");t&&H(t).forEach(n=>{N(n)})},V=e=>{N(e);const t=e.closest("li");t&&H(t).forEach(n=>{k(n)})},ze=({discountInfo:e,id:t,onLeadEntryCaptured:a,page:n,timeoutDuration:i})=>{const[u,m]=P.useState(!1),r=()=>m(!0),f=()=>m(!1);M(()=>{setTimeout(()=>{m(!0)},i)});const h=P.useRef(null);M(()=>{const l=document.querySelector("[data-lead-capture-page-hero]"),b=Array.from(document.querySelectorAll("[data-lead-capture-popup-trigger]")),S=Q(e);return b.forEach(d=>{d.addEventListener("click",r),d.innerText=`Get ${S} off`}),h.current=new IntersectionObserver(([d])=>{if(d.isIntersecting)b.forEach(p=>V(p));else{const p=y("email"),g=y("phoneNumber");y("leadCapturePopupWasClosed")&&!p&&!g&&b.forEach(T=>Qe(T))}},{threshold:.5}),h.current.observe(l),()=>{b.forEach(d=>{d.removeEventListener("click",r)}),h.current&&(h.current.disconnect(),h.current=null)}});const _=()=>{if(h.current){const l=document.querySelector("[data-lead-capture-page-hero]");l&&(h.current.unobserve(l),h.current.observe(l))}},j=()=>{f(),x("leadCapturePopupWasClosed",!0);const l=y("email"),b=y("phoneNumber");Array.from(document.querySelectorAll("[data-lead-capture-popup-trigger]")).forEach(C=>{l||b?V(C):_()});const d=y("newLeadEmail"),p=y("newLeadPhoneNumber");let g;d&&d===l?g={email:d}:p&&p===b&&(g={phoneNumber:p}),g&&(ve(g),x("willFinishSignupLater",!0))};return o.jsx(Ge,{closeModal:j,discountInfo:e,id:t,onLeadEntryCaptured:a,page:n,showModal:u})},yt=e=>{const t=document.getElementById("lead-capture-popup-container"),a="lead-capture-popup",{leadCapturePage:n,leadCaptureTimeoutDuration:i,onLeadEntryCaptured:u}=e,m=ke();re.render(o.jsx(ze,{id:a,discountInfo:m,onLeadEntryCaptured:u,page:n,timeoutDuration:i}),t)},_t=()=>{const e=document.querySelector("[data-hero-video]");new IntersectionObserver(([a])=>{e.paused&&a.isIntersecting?e.getAttribute("data-is-paused-by-control")||e.play().catch(n=>console.warn(n)):!e.paused&&!a.isIntersecting&&e.pause()}).observe(e),ae()};export{Le as L,U as a,yt as b,bt as i,gt as r,_t as s,ve as u};
//# sourceMappingURL=setUpHeroVideo.1.sha256-1bda18ef2e.js.map
